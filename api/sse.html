<html>
    <head>
        <title></title>
        <script type="text/javascript">
            function openConnection(event) {
                var url = window.location.protocol + "//" + window.location.host;
                if (event.origin === url){
                    // Message from server
                    var source = new EventSource("sendevent.php");

                    source.addEventListener('message', function(e) {                
                        var data = JSON.parse(e.data);
                    
                        e.source.postMessage(data, e.origin);
                    }, false);

                    source.addEventListener('open', function(e) {
                        // Connection was opened.
                    }, false);

                    source.addEventListener('error', function(e) {
                        if (e.readyState == EventSource.CLOSED) {
                            // Connection was closed.
                        }
                    }, false);                    
                } 
            }

            // Message from clients
            window.addEventListener('message', openConnection, false);
        </script>
    </head>
    <body></body>
</html>